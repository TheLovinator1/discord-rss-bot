{% extends "base.html" %}
{% block title %} | {{ feed.title }}{% endblock %}
{% block content %}
    <a class="text-muted text-decoration-none" href="{{ feed.link }}">
        <h2>{{ feed.title }}
            {% if not feed.updates_enabled %}
                - <span style="color: red">disabled</span>
            {% endif %}
        </h2>

    </a>
    {% if feed.subtitle %}
        <small class="text-muted text-decoration-none">{{ feed.subtitle }}</small>
    {% endif %}

    {% if feed.added %}
        Added: {{ feed.added.strftime('%Y-%m-%d, %T') }}
    {% endif %}

    {% if feed.last_exception %}
        Last exception: {{ feed.last_exception }}
    {% endif %}


    <div class="btn-toolbar" role="group">
        <div class="btn-group me-1" role="group">
            <form action="/check" method="post">
                <button class="btn btn-primary" type="submit" name="feed_url" value="{{ feed.url }}">
                    Send new entries to Discord
                </button>
            </form>
        </div>
        <div class="btn-group" role="group">
            <form action="/remove" method="post">
                <button class="btn btn-danger" type="submit" name="feed_url" value="{{ feed.url }}">
                    Remove feed
                </button>
            </form>
        </div>
    </div>
    <div class="p-2 border border-dark" style="background:#0F0F0F">
        {% for entry in entries %}
            {% if loop.index > 1 %}
                <hr>
            {% endif %}

            <a class="text-muted text-decoration-none" href="{{ entry.link }}">
                <h2>{{ entry.title }}</h2>
            </a>

            By {{ entry.author }}
            {% if entry.published %}
                @ {{ entry.published.strftime('%Y-%m-%d, %T') }}
            {% endif %}


            <p>
                {# Add a button to get the summary #}
                {% if entry.summary %}
                    <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapse_summary_{{ loop.index }}"
                       role="button">Summary</a>
                {% endif %}

                {# Add a button to get the content #}
                {% if entry.content %}
                    <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapse_content_{{ loop.index }}"
                       role="button">Content</a>
                {% endif %}
            </p>

            {% if entry.summary %}
                <div class="collapse" id="collapse_summary_{{ loop.index }}">
                    <div class="card card-body text-muted border border-dark" style="background: #111111;">
                        {{ entry.summary | safe }}
                    </div>
                </div>
            {% endif %}
            {% if entry.content %}
                <div class="collapse" id="collapse_content_{{ loop.index }}">
                    <div class="card card-body text-muted border border-dark" style="background: #111111;">
                        {{ entry.content[0].value | safe }}
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}