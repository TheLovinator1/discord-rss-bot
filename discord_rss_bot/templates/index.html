{% extends "base.html" %}
{% block content %}
    <!-- List all feeds -->
    <ul>
        <!-- Check if any feeds -->
        {% if feeds %}
            <p>
                {{ feed_count.total }} feeds
                {% if feed_count.broken %}
                    <span class="text-danger">
                {% else %}
                    <span>
                {% endif %}
                - {{ feed_count.broken }} broken</span>
                {% if feed_count.total != feed_count.updates_enabled %}
                    <span class="text-warning">
                {% else %}
                    <span>
                {% endif %}
                - {{ feed_count.updates_enabled }} enabled
                </span>
                - {{ entry_count.total }} entries
                <span data-bs-toggle="tooltip" title="Entries per day average for the past 1, 3 and 12 months">
                    ({{ entry_count.averages[0]|round(1) }},
                    {{ entry_count.averages[1]|round(1) }},
                    {{ entry_count.averages[2]|round(1) }})
                </span>
            </p>
            {% for hook_from_context in webhooks %}
                <div class="p-2 mb-2 border border-dark">
                    <ul class="list-group">{{ hook_from_context.name }}
                        {% for feed_webhook in feeds %}
                            {% set feed = feed_webhook["feed"] %}
                            {% set hook_from_feed = feed_webhook["webhook"] %}
                            {% if hook_from_context.url == hook_from_feed %}
                                <a class="text-muted"
                                   href="/feed?feed_url={{ feed.url|encode_url }}">{{ feed.url }}</a>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            {% endfor %}
        {% else %}
            <p>
                No feeds yet. Add one <a class="text-muted" href="/add">here</a>.
            </p>
        {% endif %}
    </ul>
{% endblock %}